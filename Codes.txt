PreReQ:
Creating multiple node cluster setup in AWS EMR & loading data to the S3 bucket.


1)Creating Table & loading data from S3 bucket to Hive Table:

CREATE EXTERNAL TABLE  youtubespam( comment_id STRING, author STRING, content STRING, class STRING ) ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LOCATION 's3://mycloudassginmentbucketnew/path/';


LOAD DATA INPATH 's3://mycloudassginmentbucketnew/newdata.csv' INTO TABLE youtubespam;


2)Checking if the data loaded is correct:
Select * from youtubespam LIMIT 10;


3)Cleaning Dataset:
    Removing null values:
* CREATE TABLE youtubespam_nonull AS SELECT * FROM youtubespam WHERE comment_id IS NOT NULL AND author IS NOT NULL AND content IS NOT NULL AND class IS NOT NULL;
    Trimming values:
* CREATE TABLE youtubespam_trimmed AS SELECT TRIM(comment_id) AS comment_id, TRIM(author) AS author, TRIM(content) AS content, TRIM(class) AS class FROM youtubespam_nonull;
4)A basic regular expression-based classification rule is used in SQL queries.


CREATE TABLE youtubespam_classification AS SELECT *, CASE WHEN content RLIKE '(Check|subscribe|views|trading)' THEN 'spam' ELSE 'ham' END AS classification FROM youtubespam_trimmed;


Select * from youtubespam_classification LIMIT 10;


5)Query to find the Top 10 SPAM accounts:
 SELECT author, COUNT(*) AS spam_count FROM youtubespam_classification WHERE classification = 'spam' GROUP BY author ORDER BY spam_count DESC LIMIT 10;


6)Query to find the Top 10 HAM accounts:
SELECT author, COUNT(*) AS ham_count FROM youtubespam_classification WHERE classification = 'ham' GROUP BY author ORDER BY ham_count DESC LIMIT 10;